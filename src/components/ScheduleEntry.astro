---
import Timestamp from "@components/Timestamp.astro";
const { entryId, number, title, description, startIn, endIn, isPined=false } = Astro.props
import { normalizeDateTime, friendlyDateMessage, friendlyDuration } from "@utils/TimeUtils";

const duration = friendlyDuration(normalizeDateTime(startIn),normalizeDateTime(endIn))
---
<div class="p-4 border-2 border-primary rounded-lg hover:hover-primary hover:scale-[1.02]">
	<details class="group/settings relative ">
		<summary class="list-none cursor-pointer flex items-start justify-between">
			<div class="flex-1">
				<div class="flex flex-row gap-4"> 
					<div class="shrink-0 text-primary text-lg  bg-accent flex justify-center items-center rounded-lg w-10 h-10 ">{number}</div>
					<div class="flex-1 space-y-1">
						<h1 class="text-2xl">{title}</h1>
						<h2 class="text-lg text-secondary">{description}</h2>

						<div class=" flex flex-wrap mt-4">
							<div class="flex-1">
								<h3 class="text-secondary text-lg flex flex-row items-center whitespace-nowrap">

									<svg xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 128 128" stroke="currentColor" role="img" aria-label="countdown icon">
										<circle cx="64" cy="64" r="36" fill="none"  stroke-width="8"/>
										<rect x="58" y="20" width="12" height="10" rx="3" />
										<rect x="88" y="38" width="10" height="6" rx="2" />
										<line x1="64" y1="64" x2="64" y2="40"  stroke-width="8" stroke-linecap="round"/>
									</svg>


									Status <span class="pl-2 text-primary font-bold"><Timestamp startTime={startIn} endTime={endIn} eventName="Event"/></span>
								</h3>

								<h3 class="text-secondary text-lg whitespace-nowrap flex flex-row items-center">
									<svg xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 128 128" role="img" stroke="currentColor" aria-label="duration icon">
										<circle cx="64" cy="52" r="36" fill="none"  stroke-width="8" />
										<line x1="64" y1="52" x2="64" y2="32"  stroke-width="8" stroke-linecap="round"/>
										<line x1="64" y1="52" x2="84" y2="68"  stroke-width="6" stroke-linecap="round"/>
									</svg>

									Duration <span class="text-primary font-bold ml-2">{duration}</span>
								</h3>
							</div>

							<div class="flex-1">
								<h3 class="text-secondary text-lg whitespace-nowrap flex flex-row">

									<svg width="35" height="35" viewBox="0 0 35 35" xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor">
										<rect x="4" y="6" width="22" height="20" rx="2" stroke-width="2"/>
										<line x1="4" y1="11" x2="26" y2="11" stroke-width="2"/>
										<line x1="9" y1="6" x2="9" y2="3" stroke-width="2" stroke-linecap="round"/>
										<line x1="21" y1="6" x2="21" y2="3" stroke-width="2" stroke-linecap="round"/>
										<text x="15" y="22" text-anchor="middle" font-size="12" font-weight="bold" fill="currentColor" stroke="none">S</text>
									</svg>

									Starting In <span class="text-primary font-bold ml-2">{friendlyDateMessage(normalizeDateTime(startIn))}</span>
								</h3>

								<h3 class="text-secondary text-lg whitespace-nowrap flex flex-row">

									<svg width="35" height="35" viewBox="0 0 35 35" xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor">
										<rect x="4" y="6" width="22" height="20" rx="2" stroke-width="2"/>
										<line x1="4" y1="11" x2="26" y2="11" stroke-width="2"/>
										<line x1="9" y1="6" x2="9" y2="3" stroke-width="2" stroke-linecap="round"/>
										<line x1="21" y1="6" x2="21" y2="3" stroke-width="2" stroke-linecap="round"/>
										<text x="15" y="22" text-anchor="middle" font-size="12" font-weight="bold" fill="currentColor" stroke="none">E</text>
									</svg>

									Ending In <span class="text-primary font-bold ml-2">{friendlyDateMessage(normalizeDateTime(endIn))}</span>
								</h3>
							</div>
						</div>

					</div>
				</div>

			</div>


			<svg xmlns="http://www.w3.org/2000/svg" 
				class="shrink-0 w-8 h-8 text-primary transition-transform duration-200 group-open/settings:rotate-60" 
				 fill="none" 
				 viewBox="0 0 24 24" 
				 stroke="currentColor">
			<path stroke-linecap="round" 
						stroke-linejoin="round" 
						stroke-width="2" 
						d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
			<path stroke-linecap="round" 
						stroke-linejoin="round" 
						stroke-width="2" 
						d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
			</svg>
		</summary>

		<!-- Description shown only when open -->
		<p class="mt-2 text-sm text-secondary">

		<div class="flex lg:flex-row flex-col gap-3 justify-between ml-14 mt-6">
			<div class="flex flex-row gap-3 ">
				<button class="edit-event-btn  text-lg font-semibold  px-3 py-2 border-2 border-primary rounded-lg flex flex-row items-center gap-2"
					data-event-id={entryId}
					data-event-title={title}
					data-event-description={description}
					data-event-start={startIn}
					data-event-end={endIn}
				>
					<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
						<path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
						<path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
					</svg>
					<span>
						Edit
					</span>
				</button>

				<button class="delete-event-btn text-lg font-semibold  px-3 py-2 border-2 border-primary rounded-lg flex flex-row items-center gap-2"
					data-event-id={entryId}
				>
					<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
						<polyline points="3 6 5 6 21 6"/>
						<path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
						<line x1="10" y1="11" x2="10" y2="17"/>
						<line x1="14" y1="11" x2="14" y2="17"/>
					</svg>
					<span>
						Delete
					</span>
				</button>

				<button
					class="pin-event-btn text-lg font-semibold px-3 py-2 border-2 border-primary rounded-lg flex flex-row items-center gap-2"
					data-event-id={entryId}
				>
					{isPined? (
						<>
							<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
								viewBox="0 0 24 24" fill="currentColor" class="text-primary">
								<path d="M16 4v7l2 3v2h-5v6l-1 2-1-2v-6H6v-2l2-3V4c0-1.1.9-2 2-2h4c1.1 0 2 .9 2 2z"/>
							</svg>
							<span>Unpin</span>
						</>
					) : (
						<>
							<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
								viewBox="0 0 24 24" fill="none" stroke="currentColor"
								stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
								<path d="M16 4v7l2 3v2h-5v6l-1 2-1-2v-6H6v-2l2-3V4c0-1.1.9-2 2-2h4c1.1 0 2 .9 2 2z"/>
							</svg>
							<span>Pin</span>
						</>
					)}

				</button>
			</div>



			<div class="flex flex-row gap-3">
				<button class="text-lg font-semibold  px-3 py-2 border-2 border-primary rounded-lg flex flex-row items-center gap-2">
					<svg xmlns="http://www.w3.org/2000/svg" 
						class="shrink-0 w-5 h-5 text-primary mr-2" 
						fill="none" viewBox="0 0 24 24" stroke="currentColor">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
								d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
								d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
					</svg>
					<span>
						preview
					</span>
				</button>


				<button class="text-lg font-semibold  px-3 py-2 border-2 border-primary rounded-lg flex flex-row items-center gap-2">
					<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
						<path d="M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z"/>
						<path d="m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z"/>
						<path d="M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0"/>
						<path d="M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5"/>
					</svg>
					<span class="inline-flex whitespace-nowrap">Start Now</span>
				</button>

				<button class="text-lg font-semibold  px-3 py-2 border-2 border-primary rounded-lg flex flex-row items-center gap-2">
					<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
						<circle cx="12" cy="12" r="10"/>
						<path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
						<line x1="12" y1="17" x2="12.01" y2="17"/>
					</svg>
					<span>
						Quize
					</span>
				</button>


				<button class="text-lg font-semibold  px-3 py-2 border-2 border-primary rounded-lg flex flex-row items-center gap-2">
					<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
						<path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
						<line x1="9" y1="10" x2="15" y2="10"/>
						<line x1="12" y1="7" x2="12" y2="13"/>
					</svg>
					<span>
						Response
					</span>
				</button>
			</div>

		</div>
		</p>
	</details>


</div>



